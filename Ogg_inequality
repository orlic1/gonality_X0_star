load "funcions.m";

Psi := function(N)
	S:=Factorization(N);
	psi:=1;
	for i in [1..#S] do
		psi:=psi*(S[i][1]+1)*(S[i][1]^(S[i][2]-1));
	end for;
	return psi,#S;
end function;

FirstCoprime := function (N)
	p:=2;
	while true do
		if N mod p eq 0 then 
			p:=NextPrime(p); 
		else break;
		end if;
	end while;
	return p;
end function;

L:=[];
for i in [26..13000] do
	if IsPrimePower(i) then continue i; end if;
	psi,omega:=Psi(i);
	p:=FirstCoprime(i);
	Subg:=Divisors(i);
	TN:=[**];
	for t in Subg do
   		m:=GCD(t, Numerator(i/t));
    		if m eq 1 then
      			TN:=Append(TN,t);
    		end if;
	end for;
	t:=#TN; //Order of the subgroup of involutions
	genusquotientcurve:=genereX0NQuotientWN(i,TN,t); // Return the genus of the quotient modular curve X0(N)/TN
	if ((p-1)*psi le 12*4*2^omega*(p^2+1)-12*2^omega) and (genusquotientcurve ge 5) then
		Append(~L,i);
		//i,genusquotientcurve,omega,p,(p-1)*psi/12+2^omega,4*2^omega*(p^2+1);
	end if;
end for;
L;

//the list contains 559 elements, they are
[ 192, 208, 212, 216, 218, 226, 232, 235, 237, 244, 250, 253, 265, 268, 272,
274, 278, 279, 288, 291, 292, 296, 297, 298, 301, 302, 304, 309, 314, 316, 320,
323, 324, 325, 326, 327, 328, 332, 333, 336, 338, 339, 340, 344, 346, 351, 352,
356, 358, 360, 362, 363, 364, 365, 368, 369, 371, 372, 375, 376, 377, 378, 381,
382, 384, 386, 387, 388, 391, 392, 393, 394, 396, 398, 400, 402, 403, 404, 405,
406, 407, 408, 410, 411, 412, 413, 414, 415, 416, 417, 418, 422, 423, 424, 425,
427, 428, 432, 435, 436, 437, 438, 440, 441, 442, 444, 445, 446, 447, 448, 450,
451, 452, 453, 454, 456, 458, 459, 460, 464, 465, 466, 468, 469, 470, 471, 472,
473, 474, 475, 477, 478, 480, 481, 482, 484, 485, 486, 488, 489, 490, 492, 493,
494, 495, 496, 497, 498, 500, 501, 502, 504, 505, 506, 507, 508, 511, 513, 514,
515, 516, 517, 518, 519, 520, 522, 524, 525, 526, 527, 528, 530, 531, 532, 533,
534, 535, 536, 537, 538, 539, 540, 542, 543, 544, 545, 548, 549, 550, 551, 552,
553, 554, 555, 556, 558, 559, 560, 561, 562, 564, 565, 566, 567, 568, 572, 573,
574, 575, 576, 578, 579, 580, 581, 582, 583, 584, 585, 586, 588, 589, 590, 591,
592, 594, 595, 596, 597, 598, 600, 602, 603, 604, 605, 606, 609, 610, 611, 612,
614, 615, 616, 618, 620, 621, 622, 623, 624, 627, 629, 630, 633, 635, 636, 637,
638, 639, 642, 644, 645, 646, 649, 650, 651, 654, 655, 657, 658, 660, 663, 665,
666, 667, 669, 670, 671, 672, 678, 679, 680, 681, 682, 684, 685, 689, 690, 693,
695, 696, 697, 700, 702, 703, 705, 707, 708, 710, 713, 714, 715, 720, 721, 725,
726, 728, 730, 731, 732, 735, 737, 738, 740, 741, 742, 744, 745, 748, 749, 750,
754, 755, 756, 759, 760, 762, 763, 765, 767, 770, 774, 777, 779, 780, 781, 782,
786, 790, 791, 792, 793, 795, 798, 799, 803, 804, 805, 806, 810, 812, 814, 816,
817, 819, 820, 822, 825, 826, 828, 830, 834, 836, 840, 846, 850, 851, 852, 854,
855, 858, 860, 861, 868, 870, 874, 876, 880, 882, 884, 885, 888, 890, 894, 897,
900, 902, 903, 906, 910, 912, 915, 918, 920, 924, 930, 935, 936, 938, 940, 942,
945, 946, 948, 950, 952, 954, 957, 960, 962, 966, 969, 970, 975, 978, 984, 986,
987, 988, 990, 994, 996, 1001, 1002, 1005, 1008, 1010, 1012, 1014, 1015, 1020,
1022, 1023, 1026, 1030, 1032, 1034, 1035, 1036, 1038, 1044, 1045, 1050, 1054,
1056, 1062, 1065, 1066, 1068, 1071, 1074, 1080, 1085, 1086, 1092, 1095, 1098,
1102, 1104, 1105, 1110, 1113, 1116, 1118, 1122, 1128, 1131, 1140, 1146, 1155,
1158, 1164, 1170, 1173, 1182, 1190, 1194, 1200, 1206, 1209, 1212, 1218, 1221,
1230, 1235, 1254, 1260, 1265, 1290, 1295, 1302, 1309, 1320, 1326, 1330, 1365,
1380, 1386, 1410, 1428, 1430, 1470, 1482, 1518, 1530, 1540, 1554, 1560, 1590,
1596, 1610, 1638, 1650, 1680, 1710, 1716, 1722, 1740, 1770, 1785, 1794, 1806,
1830, 1848, 1860, 1890, 1914, 1932, 1938, 1950, 1974, 1980, 2010, 2040, 2046,
2070, 2100, 2130, 2190, 2220, 2280, 2310, 2340, 2370, 2460, 2490, 2520, 2580,
2730, 2940, 3150, 3360, 3570, 3990, 4290, 4620, 4830, 5460, 6090, 6510, 6930 ];
